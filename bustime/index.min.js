import setShedules from"./setShedules.min.js";const teperatureUrl="https://rbstr.tk:3000/home",weatherUrl="https://api.openweathermap.org/data/2.5/weather?q=Mogilev&lang=ru&appid=351bef36095247499eb96265dfb607d2&units=metric",temperatureKadino=document.getElementById("temperatureKadino"),temperatureMogilev=document.getElementById("temperatureMogilev"),weatherIcon=document.getElementById("weatherIcon"),weatherDescription=document.getElementById("weatherDescription"),wind=document.getElementById("wind"),timeNowHours=document.getElementById("timeNowHours"),timeNowMins=document.getElementById("timeNowMins"),collapseKirova=document.getElementById("collapseKirova"),collapseKadino=document.getElementById("collapseKadino"),collapseVokzal=document.getElementById("collapseVokzal"),collapseRomanovichi=document.getElementById("collapseRomanovichi"),urlParams=new URLSearchParams(window.location.search),from=urlParams.get("from");let date,hours,mins,day;async function getTemperature(){temperatureKadino.innerText="",temperatureMogilev.innerText="";const e=await fetch(teperatureUrl),t=await e.json();t[0].blOut&&(temperatureKadino.innerText=t[0].blOut+"°С"),setTimeout(()=>getTemperature(),8e5)}async function getWeather(){const e=await fetch(weatherUrl),t=await e.json();if(200!==t.cod)return weatherIcon.textContent="",temperatureMogilev.textContent="",weatherDescription.textContent="",wind.textContent="",void console.log(t);weatherIcon.classList.add(`owf-${t.weather[0].id}`),temperatureMogilev.textContent=`${Math.round(t.main.temp)}°C`,weatherDescription.textContent=t.weather[0].description,wind.textContent=`ветер: ${Math.round(t.wind.speed)}м/с`,setTimeout(getWeather,1e6)}from&&(from.toLowerCase().match("kirova")&&collapseKirova.classList.add("show"),from.toLowerCase().match("kadino")&&collapseKadino.classList.add("show"),from.toLowerCase().match("vokzal")&&collapseVokzal.classList.add("show"),from.toLowerCase().match("romanovichi")&&collapseRomanovichi.classList.add("show"));const timeUpdate=()=>{const e=e=>e<10?`0${e}`:e;date=new Date,day=date.getDay(),hours=date.getHours(),mins=date.getMinutes(),timeNowHours.innerText=e(hours),timeNowMins.innerText=e(mins),setTimeout(()=>timeUpdate(),5e3)};timeUpdate(),setShedules(),getTemperature(),getWeather();
